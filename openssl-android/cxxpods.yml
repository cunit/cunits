name: openssl-android
repository: 
  url: https://github.com/passy/openssl-android.git

buildType: manual
build:
  install: 
    script: |
      echo "Building libs"

      wget https://github.com/passy/openssl-android/releases/download/1.1.0h-r2/openssl-1.1.0h-r2-prebuilt.tar.gz
      tar xvfz openssl-1.1.0h-r2-prebuilt.tar.gz
      

      set +e
      set +x

      echo "Getting ABI for ${ARCH}"
      ABI=""
      case "${ARCH}" in
        x86 | x86_64 | x64 | x32) ABI=x86;;
        arm) ABI=armeabi-v7a;;
        aarch64) ABI=arm64-v8a;;
        *) echo "ERROR: BAD: No valid open ssl for: ${ARCH}";exit -1;;
      esac

      echo "Got ABI ${ABI}"
      cp -R "libs/${ABI}/*.a" "${CXXPODS_BUILD_LIB}/"

      if [ -e "${CXXPODS_BUILD_INCLUDE}/openssl" ];then
        rm -Rf "${CXXPODS_BUILD_INCLUDE}/openssl"
      fi
      cp -R "jni/openssl-android/include/openssl" "${CXXPODS_BUILD_INCLUDE}/openssl"
  # configure:
  #   script: ./Configure --prefix=${CXXPODS_BUILD_ROOT} no-shared dist
  # build:
  #   script: make -j${CXXPODS_PROC_COUNT:-4} build_generated
  # install:
  #   script: make -j${CXXPODS_PROC_COUNT:-4} install

# cmake:
#   findTemplate: cmake/FindFFMPEG.cmake.hbs

